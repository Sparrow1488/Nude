# HTTP API Requests

## Base URL

Базовый URL для `Nude.API` стоится из:

* Domain 
* API Version 

Текущий базовый URL: `http://127.0.0.1:3001/v2/`

## Errors and Responses

После обращения к API, пользователь получает Http Response со статусом и Json моделью. Если статус ответа `200 OK`, то пользователь может десериализовать ответ в соответствии с моделью, отписанной в документации. 

Если статус ответа будет `400 Bad` или `500 External`, то ожидайте модель со структурой `ErrorResponse`

## Authentication

Для обращения к большенству ресурсов, а также получения доступа к некоторым функциям бота, необходимо авторизовать пользователя. На данный момент `Nude.API` поддерживает только авторизацию через `Nude.Bot.Tg` (Telegram бота). После начала диалога с ботом, тот автоматически создаст вам учетную запись, а также привяжет текущий телеграм аккаунт.

Чтобы авторизоваться с помощью Telegram, нужно отправить запрос:

```http
POST /auth?username=<USERNAME> HTTP/1.1
```

В случае, если пользователь с таким именем еще не добавлен в БД, он будет автоматически создан, а также к нему будет привязан `TelegramAccount` с указанным <USERNAME>.

После авторизации, вам будет отправлен следующий ответ:

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
   "token": "<ACCESS_TOKEN>"
}
```

### JWT Access Token

JWT Access Token, выданный пользователю после авторизации, может храниться неограниченное количество времени. Для обновления текущего токена, необходима повторная авторизация.

### User Claims

#### Description

После создания учетной записи, к пользователю прикрепляются `Claims`, которые содержат различную информацию, к примеру, роль в системе.

#### Claim Types

`nude.claim.role` - информация о текущей роли пользователя. Может иметь следующие значения:

* `claim.role.user` - пользовательская роль по умолчанию
* `claim.role.administrator` - пользователь с ролью администратора

Чтобы получить больше информации об ограничениях пользовательских ролей, смотрите раздел **Users**.
